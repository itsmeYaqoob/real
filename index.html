<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Real~</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: 'Roboto', Arial, sans-serif;
      background: linear-gradient(135deg, #f8fafc, #e0e7ef 60%, #c7d2fe);
      min-height: 100vh;
    }
    .navbar {
      background: #1e293b;
      color: #fff;
      padding: 1rem 2rem;
      font-size: 1.5rem;
      letter-spacing: 1px;
      box-shadow: 0 2px 8px #0001;
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
    }
    .navbar .brand {
      font-weight: bold;
      font-size: 1.7rem;
      cursor: pointer;
    }
    .container {
      width: 100%;
      margin: 3rem auto 0 auto;
      padding: 0 1rem;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 2rem;
      align-items: flex-start;
    }
    @media (max-width: 1100px) {
      .container {
        gap: 1rem;
      }
    }
    @media (max-width: 700px) {
      .container {
        flex-direction: column;
        align-items: center;
        gap: 1rem;
      }
      .card, .add-card {
        width: 95vw !important;
        margin-bottom: 1rem;
      }
      .editor-box {
        width: 90vw;
        min-width: unset;
      }
      .editor-search-box {
        width: 90vw;
      }
      .card-size-slider-wrap {
        width: 90vw;
      }
    }
    .card {
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 6px 24px #64748b30;
      width: var(--card-size, 220px);
      text-align: center;
      padding: 2rem 1.2rem 1.5rem 1.2rem;
      transition: transform 0.15s, box-shadow 0.15s, width 0.2s, height 0.2s;
      position: relative;
      overflow: hidden;
      cursor: pointer;
      user-select: none;
      min-height: 215px;
      box-sizing: border-box;
      flex: 0 0 auto;
    }
    .card:hover {
      transform: translateY(-5px) scale(1.04);
      box-shadow: 0 10px 32px #64748b40;
      background: linear-gradient(135deg, #e0e7ef 80%, #f8fafc);
    }
    .card-icon {
      font-size: 2.8rem;
      display: block;
      margin-bottom: 1.2rem;
      color: #6366f1;
      transition: color 0.2s;
    }
    .card:hover .card-icon {
      color: #1e293b;
    }
    .card-title {
      font-size: 1.12rem;
      font-weight: 700;
      color: #334155;
      margin-bottom: 0.7rem;
      letter-spacing: 0.5px;
    }
    .card-desc {
      color: #64748b;
      font-size: 0.98rem;
      margin-bottom: 1.2rem;
      min-height: 42px;
    }
    .card-link {
      display: block;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      background: #6366f1;
      color: #fff;
      text-decoration: none;
      font-weight: 500;
      font-size: 1rem;
      margin: 0 auto;
      width: fit-content;
      transition: background 0.18s;
    }
    .card-link:hover {
      background: #1e293b;
    }
    .star-btn {
      position: absolute;
      top: 8px;
      right: 8px;
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      z-index: 2;
      color: #22c55e;
      opacity: 0.7;
      transition: opacity 0.2s;
    }
    .star-btn.active {
      opacity: 1;
      color: #22c55e;
    }
    .card.dragging {
      opacity: 0.5;
      border: 2px dashed #6366f1;
    }
    .editor-modal {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: #0006;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.2s;
    }
    .editor-modal.active {
      visibility: visible;
      opacity: 1;
    }
    .editor-box {
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 6px 24px #64748b80;
      padding: 2rem;
      min-width: 320px;
      max-width: 90vw;
      width: 400px;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      gap: 1rem;
      position: relative;
    }
    .editor-box label {
      font-size: 1rem;
      color: #334155;
      font-weight: 500;
      margin-bottom: 0.25rem;
    }
    .editor-box input, .editor-box textarea {
      font-size: 1.1rem;
      padding: 0.4rem 0.6rem;
      border-radius: 8px;
      border: 1px solid #cbd5e1;
      margin-bottom: 0.5rem;
      background: #f1f5f9;
    }
    .editor-box textarea {
      resize: vertical;
      min-height: 40px;
      max-height: 120px;
    }
    .editor-actions {
      display: flex;
      gap: 1rem;
      justify-content: flex-end;
      margin-top: 0.5rem;
    }
    .editor-actions button {
      padding: 0.4rem 1rem;
      border-radius: 8px;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      background: #6366f1;
      color: #fff;
      font-weight: 500;
      transition: background 0.18s;
    }
    .editor-actions .delete-btn {
      background: #ef4444;
    }
    .editor-actions .close-btn {
      background: #64748b;
    }
    .editor-actions .save-btn {
      background: #22c55e;
    }
    .export-actions {
      margin: 1rem 0;
      display: flex;
      gap: 1rem;
      justify-content: flex-end;
    }
    .export-actions button {
      background: #334155;
      color: #fff;
      border: none;
      padding: 0.4rem 1rem;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      font-weight: 500;
      transition: background 0.18s;
    }
    .editor-search-box {
      margin: 0 auto 1rem auto;
      width: 340px;
      font-size: 1.3rem;
      padding: 0.7rem 1.1rem;
      border-radius: 12px;
      border: 1.8px solid #6366f1;
      background: #f1f5f9;
      color: #334155;
      display: block;
      box-sizing: border-box;
    }
    .add-card {
      background: #f1f5f9;
      border: 2px dashed #6366f1;
      color: #6366f1;
      border-radius: 16px;
      width: var(--card-size, 220px);
      height: 215px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.8rem;
      cursor: pointer;
      transition: background 0.18s, width 0.2s, height 0.2s;
      margin-bottom: 10px;
      user-select: none;
      min-height: 215px;
      box-sizing: border-box;
      flex: 0 0 auto;
    }
    .add-card:hover {
      background: #c7d2fe;
    }
    .card-size-slider-wrap {
      width: 350px;
      margin: 0 auto 1.2rem auto;
      text-align: center;
      display: flex;
      align-items: center;
      gap: 1rem;
      justify-content: center;
    }
    .card-size-slider-label {
      color: #334155;
      font-size: 1.07rem;
      font-weight: 500;
    }
    .card-size-slider {
      width: 150px;
      accent-color: #6366f1;
      height: 2.2em;
    }
  </style>
</head>
<body>
  <nav class="navbar" id="navbar">
    <span class="brand" id="brand-logo">Real~</span>
  </nav>
  <main>
    <div class="export-actions">
      <button id="importSettingsBtn">Import</button>
      <button id="exportSettingsBtn">Export</button>
      <button id="exportHtmlBtn">Export HTML</button>
      <input type="file" id="importFileInput" accept=".json" style="display:none;">
    </div>
    <input type="text" id="editorSearchBox" class="editor-search-box" placeholder="Search apps...">
    <div class="card-size-slider-wrap">
      <span class="card-size-slider-label">App size</span>
      <input type="range" id="cardSizeSlider" class="card-size-slider" min="160" max="320" step="10" value="220">
      <button id="resetCardSizeBtn" title="Reset card size" style="font-size:1.1rem;padding:0.2rem 0.7rem;border-radius:8px;border:none;background:#f1f5f9;color:#6366f1;cursor:pointer;">‚ü≥</button>
    </div>
    <div class="container" id="cardsContainer"></div>
  </main>
  <!-- Editor Modal -->
  <div class="editor-modal" id="editorModal">
    <form class="editor-box" id="editorForm" onsubmit="return false;">
      <label>
        Emoji
        <input type="text" id="emojiInput" maxlength="2" required>
      </label>
      <label>
        Name/Title
        <input type="text" id="titleInput" maxlength="32" required>
      </label>
      <label>
        Description
        <textarea id="descInput" maxlength="120" required></textarea>
      </label>
      <label>
        Link
        <input type="text" id="linkInput" maxlength="128" required>
      </label>
      <div class="editor-actions">
        <button type="button" class="save-btn" id="saveAppBtn">Save</button>
        <button type="button" class="delete-btn" id="deleteAppBtn">Delete</button>
        <button type="button" class="close-btn" id="closeEditorBtn">Close</button>
      </div>
    </form>
  </div>
  <script>
    const defaultApps = [
      {
        "emoji": "üìä",
        "title": "Username Find?",
        "desc": "@username researcher.",
        "link": "username finder/",
        "starred": true
      },
      {
        "emoji": "üèãÔ∏è‚Äç‚ôÇÔ∏è",
        "title": "Gravity v1",
        "desc": "Gravity Workout",
        "link": "gravity v1/",
        "starred": true
      },
      {
        "emoji": "ü™ê",
        "title": "Test here",
        "desc": "Live!",
        "link": "Testing?/",
        "starred": false
      },
      {
        "emoji": "üõ†",
        "title": "ha?",
        "desc": "",
        "link": "#",
        "starred": false
      }
    ];
    let apps = JSON.parse(localStorage.getItem('apps')) || defaultApps.slice();
    let editorMode = false;
    let editingIdx = null;
    let isNewApp = false;
    let searchValue = "";
    let cardSize = 220; // Default card size

    const cardsContainer = document.getElementById('cardsContainer');
    const editorModal = document.getElementById('editorModal');
    const emojiInput = document.getElementById('emojiInput');
    const titleInput = document.getElementById('titleInput');
    const descInput = document.getElementById('descInput');
    const linkInput = document.getElementById('linkInput');
    const saveAppBtn = document.getElementById('saveAppBtn');
    const deleteAppBtn = document.getElementById('deleteAppBtn');
    const closeEditorBtn = document.getElementById('closeEditorBtn');
    const brandLogo = document.getElementById('brand-logo');
    const exportSettingsBtn = document.getElementById('exportSettingsBtn');
    const exportHtmlBtn = document.getElementById('exportHtmlBtn');
    const importSettingsBtn = document.getElementById('importSettingsBtn');
    const importFileInput = document.getElementById('importFileInput');
    const editorSearchBox = document.getElementById('editorSearchBox');
    const cardSizeSlider = document.getElementById('cardSizeSlider');
    const resetCardSizeBtn = document.getElementById('resetCardSizeBtn');

    // Import functionality
    importSettingsBtn.addEventListener('click', () => {
      importFileInput.click();
    });
    importFileInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(event) {
        try {
          const importedApps = JSON.parse(event.target.result);
          if (Array.isArray(importedApps)) {
            apps = importedApps;
            saveApps();
            renderCards();
            alert("Settings imported successfully!");
          } else {
            alert("Invalid file. Please select a valid JSON file.");
          }
        } catch (err) {
          alert("Failed to import: " + err.message);
        }
      };
      reader.readAsText(file);
      importFileInput.value = "";
    });

    // Export JSON
    exportSettingsBtn.addEventListener('click', () => {
      const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(apps, null, 2));
      const dl = document.createElement('a');
      dl.setAttribute("href", dataStr);
      dl.setAttribute("download", "apps.json");
      dl.click();
    });

    // Export HTML (full file with user changes)
    exportHtmlBtn.addEventListener('click', () => {
      // Get the current full HTML code and replace the defaultApps array with the current apps
      let html = document.documentElement.outerHTML;
      html = html.replace(
        /const defaultApps = (\[[\s\S]*?\]);/,
        `const defaultApps = ${JSON.stringify(apps, null, 2)};`
      );
      // Download the updated HTML file
      const dataStr = "data:text/html;charset=utf-8," + encodeURIComponent(html);
      const dl = document.createElement('a');
      dl.setAttribute("href", dataStr);
      dl.setAttribute("download", "index.html");
      dl.click();
    });

    function renderCards() {
      cardsContainer.innerHTML = '';
      let filteredApps = apps;
      if (searchValue.trim()) {
        const sv = searchValue.trim().toLowerCase();
        filteredApps = apps.filter(app =>
          app.title.toLowerCase().includes(sv) ||
          app.desc.toLowerCase().includes(sv) ||
          app.emoji.toLowerCase().includes(sv)
        );
      }
      let appList = filteredApps.slice();
      cardsContainer.style.setProperty('--card-size', cardSize + 'px');
      appList.forEach((app, idx) => {
        const card = document.createElement('div');
        card.className = 'card';
        card.draggable = true;
        card.dataset.idx = apps.indexOf(app);
        card.style.setProperty('--card-size', cardSize + 'px');
        const starBtn = document.createElement('button');
        starBtn.className = 'star-btn' + (app.starred ? ' active' : '');
        starBtn.innerText = app.starred ? '‚òÖ' : '‚òÜ';
        starBtn.title = app.starred ? 'Unstar' : 'Star';
        starBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          app.starred = !app.starred;
          saveApps();
          renderCards();
        });
        card.appendChild(starBtn);
        const icon = document.createElement('span');
        icon.className = 'card-icon';
        icon.innerText = app.emoji;
        card.appendChild(icon);
        const title = document.createElement('div');
        title.className = 'card-title';
        title.innerText = app.title;
        card.appendChild(title);
        const desc = document.createElement('div');
        desc.className = 'card-desc';
        desc.innerText = app.desc;
        card.appendChild(desc);
        const link = document.createElement('a');
        link.className = 'card-link';
        link.href = app.link;
        link.innerText = 'Access';
        link.target = '_blank';
        card.appendChild(link);
        card.addEventListener('click', (e) => {
          if(editorMode) {
            openEditor(apps.indexOf(app));
          }
        });
        card.addEventListener('dragstart', (e) => {
          card.classList.add('dragging');
          e.dataTransfer.setData('text/plain', apps.indexOf(app));
        });
        card.addEventListener('dragend', () => {
          card.classList.remove('dragging');
        });
        card.addEventListener('dragover', (e) => {
          e.preventDefault();
        });
        card.addEventListener('drop', (e) => {
          e.preventDefault();
          const fromIdx = parseInt(e.dataTransfer.getData('text/plain'));
          const toIdx = parseInt(card.dataset.idx);
          if(editorMode || apps[fromIdx].starred === apps[toIdx].starred) {
            const fromApp = apps[fromIdx];
            apps.splice(toIdx, 0, apps.splice(fromIdx, 1)[0]);
            saveApps();
            renderCards();
          }
        });
        cardsContainer.appendChild(card);
      });
      if(editorMode){
        const addCard = document.createElement('div');
        addCard.className = 'add-card';
        addCard.style.setProperty('--card-size', cardSize + 'px');
        addCard.innerHTML = '<span style="font-size:3.5rem;">+</span>';
        addCard.title = 'Add new app';
        addCard.onclick = () => openEditor(null);
        cardsContainer.appendChild(addCard);
      }
    }
    function saveApps() {
      localStorage.setItem('apps', JSON.stringify(apps));
    }
    function openEditor(idx=null) {
      editorModal.classList.add('active');
      editorMode = true;
      editingIdx = idx;
      isNewApp = idx === null;
      if(isNewApp) {
        emojiInput.value = "";
        titleInput.value = "";
        descInput.value = "";
        linkInput.value = "";
        deleteAppBtn.style.display = "none";
      } else {
        const app = apps[idx];
        emojiInput.value = app.emoji;
        titleInput.value = app.title;
        descInput.value = app.desc;
        linkInput.value = app.link;
        deleteAppBtn.style.display = "inline-block";
      }
    }
    function closeEditor() {
      editorModal.classList.remove('active');
      editingIdx = null;
      isNewApp = false;
      editorForm.reset();
    }
    function saveEditorApp() {
      const emoji = emojiInput.value || "üõ†";
      const title = titleInput.value || "Untitled";
      const desc = descInput.value || "";
      const link = linkInput.value || "#";
      if(isNewApp) {
        apps.push({
          emoji, title, desc, link, starred: false
        });
      } else {
        const app = apps[editingIdx];
        app.emoji = emoji;
        app.title = title;
        app.desc = desc;
        app.link = link;
      }
      saveApps();
      renderCards();
      closeEditor();
    }
    function deleteEditorApp() {
      if(isNewApp) {
        closeEditor();
        return;
      }
      apps.splice(editingIdx, 1);
      saveApps();
      renderCards();
      closeEditor();
    }

    saveAppBtn.addEventListener('click', saveEditorApp);
    deleteAppBtn.addEventListener('click', deleteEditorApp);
    closeEditorBtn.addEventListener('click', closeEditor);

    brandLogo.addEventListener('click', () => {
      editorMode = !editorMode;
      brandLogo.style.textDecoration = editorMode ? 'underline' : 'none';
      renderCards();
    });
    editorModal.addEventListener('click', (e) => {
      if(e.target === editorModal) closeEditor();
    });
    editorSearchBox.addEventListener('input', (e) => {
      searchValue = e.target.value;
      renderCards();
    });
    cardSizeSlider.addEventListener('input', (e) => {
      cardSize = parseInt(e.target.value,10);
      renderCards();
    });
    resetCardSizeBtn.addEventListener('click', () => {
      cardSize = 220;
      cardSizeSlider.value = 220;
      renderCards();
    });
    renderCards();
  </script>
</body>
</html>
